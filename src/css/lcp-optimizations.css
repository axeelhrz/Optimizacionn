/* ===== LCP CRITICAL OPTIMIZATIONS ===== */

/* Critical above-the-fold optimizations */
.hero {
    /* Ensure hero section renders immediately */
    contain: layout style paint;
    will-change: auto;
}

.hero__container {
    /* Optimize container rendering */
    contain: layout style;
}

/* LCP Element Optimizations */
.hero__phone-app-image,
.hero__phone-video,
.hero__mobile-video-player {
    /* Critical rendering optimizations */
    transform: translateZ(0);
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    image-rendering: -webkit-optimize-contrast;
    image-rendering: optimize-contrast;
    
    /* Prevent layout shifts */
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
}

/* Mobile LCP optimizations */
@media (max-width: 1023px) {
    .hero__mobile-video {
        /* Ensure immediate visibility */
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
        
        /* Optimize rendering */
        contain: layout style paint;
        transform: translateZ(0);
        
        /* Prevent layout shift */
        aspect-ratio: 9/16;
        max-width: 320px;
        width: 100%;
        margin: var(--space-xl) auto 0;
    }
    
    .hero__mobile-video-player {
        /* Critical mobile video styles */
        display: block !important;
        width: 100% !important;
        height: auto !important;
        border-radius: 12.8% !important;
        
        /* Performance optimizations */
        will-change: auto;
        transform: translateZ(0);
        backface-visibility: hidden;
        
        /* Smooth loading transition */
        transition: opacity 0.2s ease;
    }
    
    .hero__mobile-video-player.loading {
        opacity: 0.8;
    }
    
    .hero__mobile-video-player.loaded {
        opacity: 1;
    }
    
    /* Hide desktop elements immediately */
    .hero__media,
    .hero__phone,
    .hero__phone-container,
    .hero__phone-screen,
    .hero__phone-content,
    .hero__phone-video,
    .hero__phone-app-image {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        pointer-events: none !important;
    }
}

/* Desktop LCP optimizations */
@media (min-width: 1024px) {
    .hero__phone-container {
        /* Optimize 3D transform */
        transform: perspective(1200px) rotateY(-8deg) rotateX(2deg);
        transform-style: preserve-3d;
        will-change: transform;
        contain: layout style paint;
    }
    
    .hero__phone {
        /* Optimize phone container */
        width: 280px;
        height: 560px;
        border-radius: 40px;
        contain: layout style paint;
        position: relative;
    }
    
    .hero__phone-app-image {
        /* Image loads first for LCP */
        position: absolute;
        top: 0;
        left: 0;
        z-index: 1;
        display: block;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        border-radius: 40px;
        
        /* Immediate visibility */
        opacity: 1 !important;
        visibility: visible !important;
        
        /* Performance */
        will-change: auto;
        transform: translateZ(0);
    }
    
    .hero__phone-video {
        /* Video loads after image */
        position: absolute;
        top: 0;
        left: 0;
        z-index: 1;
        border-radius: 40px;
        opacity: 0;
        transition: opacity 0.3s ease;
        
        /* Performance */
        will-change: opacity;
        transform: translateZ(0);
    }
    
    .hero__phone-video.loaded {
        z-index: 2;
        opacity: 1;
    }
    
    .hero__phone-video.error {
        display: none;
    }
    
    /* Hide mobile elements */
    .hero__mobile-video {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
    }
}

/* Loading states for LCP elements */
.hero__phone-app-image.loading,
.hero__mobile-video-player.loading {
    opacity: 0.8;
    filter: brightness(0.9);
}

.hero__phone-app-image.loaded,
.hero__mobile-video-player.loaded {
    opacity: 1;
    filter: brightness(1);
}

.hero__phone-app-image.error,
.hero__mobile-video-player.error {
    opacity: 0.7;
    filter: grayscale(0.3);
}

/* Video fallback styles */
.video-fallback {
    display: block !important;
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
    border-radius: inherit !important;
    opacity: 1 !important;
}

/* Performance mode optimizations */
.performance-mode .hero__phone-video,
.performance-mode .hero__mobile-video-player {
    display: none !important;
}

.performance-mode .hero__phone-app-image {
    z-index: 2 !important;
    opacity: 1 !important;
    display: block !important;
}

.performance-mode .hero__mobile-video {
    background-size: cover !important;
    background-position: center !important;
    background-repeat: no-repeat !important;
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    .hero__phone-video,
    .hero__mobile-video-player {
        display: none !important;
    }
    
    .hero__phone-app-image {
        z-index: 2 !important;
        opacity: 1 !important;
        transition: none !important;
    }
    
    .hero__mobile-video {
        background-size: cover !important;
        background-position: center !important;
    }
}

/* Critical font loading optimization */
@font-face {
    font-family: 'Space Grotesk';
    font-style: normal;
    font-weight: 400;
    font-display: swap;
    src: url('https://fonts.gstatic.com/s/spacegrotesk/v13/V8mQQoyeyHLkMX7Mq-HNsXfcBcKFhfhJvl7lqVTk.woff2') format('woff2');
    unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
    font-family: 'Space Grotesk';
    font-style: normal;
    font-weight: 700;
    font-display: swap;
    src: url('https://fonts.gstatic.com/s/spacegrotesk/v13/V8mQQoyeyHLkMX7Mq-HNsXfcBcKFhfhJvl7lqVTk.woff2') format('woff2');
    unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

/* Critical text rendering */
.hero__title,
.hero__subtitle,
.hero__company-description-text {
    /* Optimize text rendering for LCP */
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    
    /* Prevent layout shifts */
    font-kerning: none;
    font-variant-ligatures: none;
}

/* Prevent cumulative layout shift */
.hero__title {
    /* Reserve space for title */
    min-height: clamp(8rem, 20vw, 16rem);
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.hero__company-description {
    /* Reserve space for description */
    min-height: clamp(4rem, 8vh, 6rem);
}

.hero__subtitle {
    /* Reserve space for subtitle */
    min-height: clamp(2rem, 4vh, 3rem);
}

/* Image optimization for download buttons */
.download-btn__image {
    /* Prevent layout shift */
    width: 200px !important;
    height: 60px !important;
    object-fit: contain !important;
    
    /* Optimize rendering */
    image-rendering: -webkit-optimize-contrast;
    image-rendering: optimize-contrast;
    transform: translateZ(0);
    backface-visibility: hidden;
}

/* Critical visibility utilities */
.mobile-only {
    display: none;
}

.desktop-only {
    display: block;
}

@media (max-width: 1023px) {
    .mobile-only {
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
    }
    
    .desktop-only {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
    }
}

/* Intersection Observer optimization */
.hero {
    /* Ensure hero is always visible */
    opacity: 1 !important;
    visibility: visible !important;
    transform: none !important;
}

/* Critical loading indicators */
.lcp-loading {
    position: relative;
}

.lcp-loading::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 20px;
    height: 20px;
    margin: -10px 0 0 -10px;
    border: 2px solid var(--starflex-red);
    border-top: 2px solid transparent;
    border-radius: 50%;
    animation: lcp-spin 1s linear infinite;
}

.lcp-loaded::after {
    display: none;
}

@keyframes lcp-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* High DPI optimizations */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    .hero__phone-app-image,
    .hero__mobile-video-player {
        image-rendering: -webkit-optimize-contrast;
        image-rendering: optimize-contrast;
    }
}

/* Connection-aware optimizations */
@media (prefers-reduced-data: reduce) {
    .hero__phone-video,
    .hero__mobile-video-player {
        display: none !important;
    }
    
    .hero__phone-app-image {
        z-index: 2 !important;
        display: block !important;
    }
    
    .hero__mobile-video {
        background-size: cover !important;
        background-position: center !important;
    }
}
